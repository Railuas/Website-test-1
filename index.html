<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAUS News - Caribbean News Network</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== GLOBAL STYLES ===== */
        :root {
            --primary: #0056b3;
            --secondary: #e63946;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --text: #333;
            --text-light: #6c757d;
            --font-main: 'Montserrat', sans-serif;
            --font-heading: 'Playfair Display', serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-main);
            color: var(--text);
            background: var(--light);
            line-height: 1.6;
        }
        
        h1, h2, h3, h4 {
            font-family: var(--font-heading);
            margin-bottom: 1rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-weight: 600;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #004494;
        }
        
        section {
            padding: 40px 0;
        }
        
        /* ===== HEADER STYLES ===== */
        header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }
        
        .logo h1 {
            color: var(--primary);
            font-size: 2rem;
        }
        
        .logo p {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        /* ===== NAVIGATION ===== */
        nav {
            background: var(--dark);
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li a {
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            display: block;
            transition: all 0.3s ease;
        }
        
        .nav-links li a:hover {
            background: rgba(255,255,255,0.1);
        }
        
        /* ===== HERO SECTION ===== */
        .hero {
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://images.unsplash.com/photo-1564501049412-61c2a3083791?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1632&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 100px 0;
            text-align: center;
        }
        
        .hero h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        /* ===== LOADING STATES ===== */
        .loading-spinner {
            grid-column: 1 / -1;
            text-align: center;
            padding: 3rem;
            color: var(--primary);
        }
        
        .loading-spinner i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ===== ERROR STATES ===== */
        .error-message {
            grid-column: 1 / -1;
            text-align: center;
            padding: 2rem;
            background: #fff8f8;
            border: 1px solid var(--secondary);
            border-radius: 8px;
            margin: 1rem 0;
        }
        
        .error-message p:first-child {
            color: var(--secondary);
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .error-message small {
            color: var(--text-light);
            font-size: 0.8rem;
        }
        
        /* ===== NEWS GRID ===== */
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }
        
        .news-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .news-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .news-image {
            height: 200px;
            overflow: hidden;
        }
        
        .news-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .news-card:hover .news-image img {
            transform: scale(1.05);
        }
        
        .news-content {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .news-source {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-bottom: 10px;
        }
        
        .news-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .news-date {
            color: var(--text-light);
            font-size: 0.8rem;
            margin-top: auto;
            padding-top: 10px;
        }
        
        .news-link {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            margin-top: 10px;
            display: inline-block;
        }
        
        .news-link:hover {
            text-decoration: underline;
        }
        
        /* ===== ARTICLE DETAIL PAGE ===== */
        .article-detail {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .article-header {
            margin-bottom: 30px;
        }
        
        .article-title {
            font-size: 2rem;
            margin-bottom: 15px;
        }
        
        .article-meta {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            color: var(--text-light);
        }
        
        .article-source {
            background: var(--primary);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-right: 15px;
        }
        
        .article-date {
            font-size: 0.9rem;
        }
        
        .article-image {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .article-content {
            line-height: 1.8;
        }
        
        .article-content p {
            margin-bottom: 20px;
        }
        
        .back-link {
            display: inline-block;
            margin-top: 30px;
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        /* ===== WEATHER WIDGET ===== */
        .weather-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .weather-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .weather-temp {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .weather-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .weather-detail {
            text-align: center;
        }
        
        .weather-detail i {
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: var(--primary);
        }
        
        /* ===== EVENT CALENDAR ===== */
        .events-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .event-card {
            display: flex;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .event-date {
            background: var(--primary);
            color: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            min-width: 70px;
            margin-right: 15px;
        }
        
        .event-day {
            font-size: 1.5rem;
            font-weight: bold;
            line-height: 1;
        }
        
        .event-month {
            font-size: 0.8rem;
            text-transform: uppercase;
        }
        
        .event-details {
            flex: 1;
        }
        
        .event-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .event-location {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        /* ===== FOOTER ===== */
        footer {
            background: var(--dark);
            color: white;
            padding: 40px 0;
            margin-top: 50px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
        }
        
        .footer-column h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .footer-column ul {
            list-style: none;
        }
        
        .footer-column ul li {
            margin-bottom: 8px;
        }
        
        .footer-column ul li a {
            color: #ddd;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-column ul li a:hover {
            color: white;
        }
        
        .copyright {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
            color: #aaa;
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-links {
                flex-direction: column;
            }
            
            .hero {
                padding: 60px 0;
            }
            
            .hero h2 {
                font-size: 2rem;
            }
            
            .weather-details {
                grid-template-columns: 1fr;
            }
            
            .article-image {
                height: 250px;
            }
            
            .event-card {
                flex-direction: column;
            }
            
            .event-date {
                margin-right: 0;
                margin-bottom: 15px;
                max-width: 70px;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER SECTION -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1>KAUS News</h1>
                    <p>Caribbean News Network</p>
                </div>
                <div class="auth-section">
                    <a href="#" id="loginBtn" class="btn btn-primary">Login</a>
                    <div id="userDropdown" class="user-dropdown">
                        <p>Logged in as <span id="userEmail"></span></p>
                        <a href="#" id="logoutBtn" class="btn btn-primary">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- NAVIGATION -->
    <nav>
        <div class="container">
            <ul class="nav-links">
                <li><a href="#" data-section="home">Home</a></li>
                <li><a href="#" data-section="weather">Weather</a></li>
                <li><a href="#" data-section="events">Events</a></li>
                <li><a href="#" data-section="about">About</a></li>
                <li><a href="#" data-section="contact">Contact</a></li>
            </ul>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="container">
        <!-- HERO SECTION -->
        <section class="hero">
            <div class="container">
                <h2>Latest Caribbean News & Updates</h2>
                <p>Stay informed with real-time news from across the islands</p>
            </div>
        </section>

        <!-- HOME SECTION -->
        <section id="home-section">
            <h2>Top Stories</h2>
            <div id="newsFeed" class="news-grid">
                <div class="loading-spinner">
                    <i class="fas fa-spinner"></i>
                    <p>Loading news feed...</p>
                </div>
            </div>
            
            <div id="dashboard" style="display: none;">
                <h2>Your Reporter Dashboard</h2>
                <div id="reporterNewsFeed" class="news-grid"></div>
                
                <form id="articleForm" class="dashboard-form">
                    <h2>Submit New Article</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="articleTitle">Title</label>
                            <input type="text" id="articleTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="articleAuthor">Your Name</label>
                            <input type="text" id="articleAuthor" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="articleExcerpt">Short Description</label>
                        <input type="text" id="articleExcerpt" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="articleContent">Full Content</label>
                        <textarea id="articleContent" required></textarea>
                    </div>
                    
                    <div class="image-upload">
                        <label for="articleImage">Featured Image</label>
                        <input type="file" id="articleImage" accept="image/*">
                        <div id="imagePreview" class="image-preview">
                            <img id="previewImage" src="#" alt="Preview">
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Publish Article</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- ARTICLE DETAIL SECTION -->
        <section id="article-section" style="display: none;">
            <div id="articleDetail" class="article-detail"></div>
        </section>

        <!-- WEATHER SECTION -->
        <section id="weather-section" style="display: none;">
            <h2>Caribbean Weather</h2>
            <div class="weather-card">
                <div class="weather-header">
                    <div>
                        <h3>Basseterre, St. Kitts</h3>
                        <p id="weather-desc">Loading weather...</p>
                    </div>
                    <div class="weather-temp" id="weather-temp">--°C</div>
                </div>
                <div class="weather-details">
                    <div class="weather-detail">
                        <i class="fas fa-wind"></i>
                        <p>Wind</p>
                        <p id="weather-wind">-- km/h</p>
                    </div>
                    <div class="weather-detail">
                        <i class="fas fa-tint"></i>
                        <p>Humidity</p>
                        <p id="weather-humidity">--%</p>
                    </div>
                    <div class="weather-detail">
                        <i class="fas fa-sun"></i>
                        <p>UV Index</p>
                        <p id="weather-uv">--</p>
                    </div>
                </div>
            </div>
            
            <h3 style="margin-top: 30px;">Other Islands</h3>
            <div id="weather-grid" class="news-grid"></div>
        </section>

        <!-- EVENTS SECTION -->
        <section id="events-section" style="display: none;">
            <h2>Upcoming Events</h2>
            <div id="eventsFeed" class="events-section"></div>
        </section>

        <!-- ABOUT SECTION -->
        <section id="about-section" style="display: none;">
            <div class="page-content">
                <h2>About KAUS News</h2>
                <p>KAUS News is the premier source for Caribbean news, delivering accurate and timely information from across the islands. Our team of dedicated journalists works around the clock to bring you the latest developments in politics, business, culture, and more.</p>
                <p>Founded in 1995, we have grown to become the most trusted news source in the Eastern Caribbean, with bureaus in St. Kitts, Nevis, Antigua, and Barbados.</p>
            </div>
        </section>

        <!-- CONTACT SECTION -->
        <section id="contact-section" style="display: none;">
            <div class="page-content">
                <h2>Contact Us</h2>
                <form id="contactForm" name="contact" method="POST" data-netlify="true">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="message">Message</label>
                        <textarea id="message" name="message" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Send Message</button>
                </form>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>KAUS News</h3>
                    <p>Your trusted source for Caribbean news and information since 1995.</p>
                </div>
                <div class="footer-column">
                    <h3>Countries</h3>
                    <ul>
                        <li><a href="#">St. Kitts & Nevis</a></li>
                        <li><a href="#">Antigua & Barbuda</a></li>
                        <li><a href="#">Barbados</a></li>
                        <li><a href="#">Jamaica</a></li>
                        <li><a href="#">Guyana</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Company</h3>
                    <ul>
                        <li><a href="#" data-section="about">About Us</a></li>
                        <li><a href="#" data-section="contact">Contact</a></li>
                        <li><a href="#">Careers</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Connect</h3>
                    <ul>
                        <li><a href="#"><i class="fab fa-facebook"></i> Facebook</a></li>
                        <li><a href="#"><i class="fab fa-twitter"></i> Twitter</a></li>
                        <li><a href="#"><i class="fab fa-instagram"></i> Instagram</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 KAUS News Network. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    
    <script>
        // ===== NEWS LOADER =====
        async function loadNews() {
            const newsFeed = document.getElementById('newsFeed');
            
            try {
                // Show loading state
                newsFeed.innerHTML = `
                    <div class="loading-spinner">
                        <i class="fas fa-spinner"></i>
                        <p>Loading latest news...</p>
                    </div>
                `;
                
                // Try Netlify function first
                let response = await fetch('/.netlify/functions/getCaribbeanNews');
                
                if (!response.ok) {
                    throw new Error('Failed to load news from our server');
                }
                
                let data = await response.json();
                
                // Handle different response formats
                let articles = Array.isArray(data) ? data : 
                              data.articles ? data.articles :
                              data.results ? data.results : 
                              [];
                
                if (articles.length === 0) {
                    // Fallback to direct API if no articles
                    response = await fetch('https://newsapi.org/v2/top-headlines?country=kn&apiKey=YOUR_API_KEY');
                    data = await response.json();
                    articles = data.articles || [];
                }
                
                if (articles.length === 0) {
                    throw new Error('No articles available at this time');
                }
                
                // Display articles
                displayNews(articles.slice(0, 6));
                
            } catch (error) {
                console.error('News load error:', error);
                newsFeed.innerHTML = `
                    <div class="error-message">
                        <p>?? News feed unavailable</p>
                        <p>We're experiencing technical difficulties. Please try again later.</p>
                        <p><small>${error.message}</small></p>
                    </div>
                `;
            }
        }
        
        function displayNews(articles) {
            const newsFeed = document.getElementById('newsFeed');
            
            newsFeed.innerHTML = articles.map(article => `
                <div class="news-card" onclick="showArticleDetail(${JSON.stringify(article).replace(/"/g, '&quot;')})">
                    <div class="news-image">
                        <img src="${article.urlToImage || article.image_url || 'https://via.placeholder.com/300x200?text=News+Image'}" 
                             alt="${article.title}"
                             onerror="this.src='https://via.placeholder.com/300x200?text=Image+Not+Available'">
                    </div>
                    <div class="news-content">
                        <span class="news-source">${article.source?.name || 'Caribbean News'}</span>
                        <h3 class="news-title">${article.title}</h3>
                        <p>${article.description || 'No description available'}</p>
                        <p class="news-date">${formatDate(article.publishedAt || article.pubDate)}</p>
                        <a href="${article.url}" target="_blank" class="news-link">Read More</a>
                    </div>
                </div>
            `).join('');
        }
        
        function formatDate(dateString) {
            if (!dateString) return "Recent";
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            } catch {
                return "Recent";
            }
        }
        
        // ===== ARTICLE DETAIL VIEW =====
        function showArticleDetail(article) {
            // Hide all sections
            document.querySelectorAll('main > section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show article section
            document.getElementById('article-section').style.display = 'block';
            
            // Populate article detail
            document.getElementById('articleDetail').innerHTML = `
                <div class="article-header">
                    <span class="article-source">${article.source?.name || "KAUS News"}</span>
                    <span class="article-date">${formatDate(article.publishedAt || article.pubDate)}</span>
                    <h1 class="article-title">${article.title}</h1>
                    <div class="article-meta">
                        <span>By ${article.author || "KAUS Reporter"}</span>
                    </div>
                </div>
                
                <img src="${article.urlToImage || article.image_url || 'https://via.placeholder.com/800x400?text=News+Image'}" 
                     alt="${article.title}" 
                     class="article-image"
                     onerror="this.src='https://via.placeholder.com/800x400?text=Image+Not+Available'">
                
                <div class="article-content">
                    ${article.content ? article.content.replace(/\n/g, '<p>') : 
                      `<p>${article.description || 'No content available'}</p>`}
                    
                    ${article.url ? `<p><a href="${article.url}" target="_blank" class="btn btn-primary">Read Full Story</a></p>` : ''}
                </div>
                
                <a href="#" onclick="showSection('home'); return false;" class="back-link">
                    <i class="fas fa-arrow-left"></i> Back to News
                </a>
            `;
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // ===== PAGE NAVIGATION =====
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('main > section').forEach(sec => {
                sec.style.display = 'none';
            });
            
            // Show selected section
            const sectionEl = document.getElementById(`${section}-section`);
            if (sectionEl) sectionEl.style.display = 'block';
            
            // Load data for section
            switch(section) {
                case 'home': 
                    loadNews(); 
                    break;
                case 'weather': 
                    loadWeather(); 
                    break;
                case 'events': 
                    loadEvents(); 
                    break;
            }
            
            window.scrollTo(0, 0);
        }
        
        // ===== WEATHER LOADER =====
        async function loadWeather() {
            try {
                const response = await fetch('/.netlify/functions/getWeather?city=Basseterre');
                const data = await response.json();
                
                document.getElementById('weather-desc').textContent = data.condition;
                document.getElementById('weather-temp').textContent = `${data.temp_c}°C`;
                document.getElementById('weather-wind').textContent = `${data.wind_kph} km/h`;
                document.getElementById('weather-humidity').textContent = `${data.humidity}%`;
                document.getElementById('weather-uv').textContent = data.uv;
                
                // Load other islands
                const islands = ["Nevis", "Antigua", "Barbados", "Jamaica"];
                const weatherGrid = document.getElementById('weather-grid');
                weatherGrid.innerHTML = '';
                
                for (const island of islands) {
                    const islandResponse = await fetch(`/.netlify/functions/getWeather?city=${island}`);
                    const islandData = await islandResponse.json();
                    
                    weatherGrid.innerHTML += `
                        <div class="weather-card">
                            <div class="weather-header">
                                <div>
                                    <h4>${island}</h4>
                                    <p>${islandData.condition}</p>
                                </div>
                                <div class="weather-temp">${islandData.temp_c}°C</div>
                            </div>
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error("Weather load error:", error);
                document.getElementById('weather-desc').textContent = "Weather data unavailable";
            }
        }
        
        // ===== EVENTS LOADER =====
        async function loadEvents() {
            try {
                const response = await fetch('/.netlify/functions/getEvents');
                const events = await response.json();
                
                const eventsFeed = document.getElementById('eventsFeed');
                eventsFeed.innerHTML = events.map(event => `
                    <div class="event-card">
                        <div class="event-date">
                            <div class="event-day">${new Date(event.start.local).getDate()}</div>
                            <div class="event-month">${new Date(event.start.local).toLocaleString('default', { month: 'short' })}</div>
                        </div>
                        <div class="event-details">
                            <div class="event-title">${event.name.text}</div>
                            <div class="event-location"><i class="fas fa-map-marker-alt"></i> ${event.venue.name}</div>
                            <p>${event.description.text.substring(0, 150)}...</p>
                        </div>
                    </div>
                `).join('');
                
            } catch (error) {
                console.error("Events load error:", error);
                document.getElementById('eventsFeed').innerHTML = `
                    <div class="error-message">
                        <p>?? Events unavailable</p>
                        <p>Check back later for upcoming events</p>
                    </div>
                `;
            }
        }
        
        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Netlify Identity
            if (window.netlifyIdentity) {
                window.netlifyIdentity.on('init', user => {
                    if (user) {
                        document.getElementById('loginBtn').style.display = 'none';
                        document.getElementById('userDropdown').style.display = 'block';
                        document.getElementById('userEmail').textContent = user.email;
                        document.getElementById('dashboard').style.display = 'block';
                    }
                });
                
                window.netlifyIdentity.on('login', user => {
                    window.location.href = '/admin/';
                });
            }
            
            // Set up navigation
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    showSection(link.getAttribute('data-section'));
                });
            });
            
            // Initialize contact form
            document.getElementById('contactForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                
                try {
                    const response = await fetch('/', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        body: new URLSearchParams(formData).toString()
                    });
                    
                    if (response.ok) {
                        alert('Thank you for your message!');
                        e.target.reset();
                    }
                } catch (error) {
                    alert('Error submitting form. Please try again.');
                }
            });
            
            // Load initial content
            showSection('home');
        });
    </script>
</body>
</html>